<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>OAuth | FeathersJS</title>
    <meta name="description" content="A REST and real-time API layer for modern applications">
    <meta name="generator" content="VuePress 1.3.1">
    
    
    <link rel="preload" href="/assets/css/0.styles.102bb3ad.css" as="style"><link rel="preload" href="/assets/js/app.59d86e45.js" as="script"><link rel="preload" href="/assets/js/2.88ab971d.js" as="script"><link rel="preload" href="/assets/js/20.c87b6b4b.js" as="script"><link rel="prefetch" href="/assets/js/10.d28788f7.js"><link rel="prefetch" href="/assets/js/11.db3b3c3f.js"><link rel="prefetch" href="/assets/js/12.0c17988b.js"><link rel="prefetch" href="/assets/js/13.25a3f2da.js"><link rel="prefetch" href="/assets/js/14.6d5f53a9.js"><link rel="prefetch" href="/assets/js/15.09e84949.js"><link rel="prefetch" href="/assets/js/16.3dc7903d.js"><link rel="prefetch" href="/assets/js/17.3ad96f5b.js"><link rel="prefetch" href="/assets/js/18.94f4c2e4.js"><link rel="prefetch" href="/assets/js/19.4f67be87.js"><link rel="prefetch" href="/assets/js/21.19f6f2a0.js"><link rel="prefetch" href="/assets/js/22.c3cf778b.js"><link rel="prefetch" href="/assets/js/23.4740bef1.js"><link rel="prefetch" href="/assets/js/24.9876f7d4.js"><link rel="prefetch" href="/assets/js/25.69f746c2.js"><link rel="prefetch" href="/assets/js/26.6dc49000.js"><link rel="prefetch" href="/assets/js/27.1456a8f1.js"><link rel="prefetch" href="/assets/js/28.bdf59f06.js"><link rel="prefetch" href="/assets/js/29.c964652f.js"><link rel="prefetch" href="/assets/js/3.ed02312c.js"><link rel="prefetch" href="/assets/js/30.d61f85f8.js"><link rel="prefetch" href="/assets/js/31.e7994f06.js"><link rel="prefetch" href="/assets/js/32.a9b283d3.js"><link rel="prefetch" href="/assets/js/33.9c6a08bd.js"><link rel="prefetch" href="/assets/js/34.11d5745a.js"><link rel="prefetch" href="/assets/js/35.7a4b4d11.js"><link rel="prefetch" href="/assets/js/36.8d11ddfe.js"><link rel="prefetch" href="/assets/js/37.326e5b1a.js"><link rel="prefetch" href="/assets/js/38.7ac3a2f4.js"><link rel="prefetch" href="/assets/js/39.ea2773d8.js"><link rel="prefetch" href="/assets/js/4.95258ed8.js"><link rel="prefetch" href="/assets/js/40.44c5bf61.js"><link rel="prefetch" href="/assets/js/41.fb67062d.js"><link rel="prefetch" href="/assets/js/42.46c09c7a.js"><link rel="prefetch" href="/assets/js/43.ad7f3a79.js"><link rel="prefetch" href="/assets/js/44.1437f97c.js"><link rel="prefetch" href="/assets/js/45.f37cb0d2.js"><link rel="prefetch" href="/assets/js/46.956e8702.js"><link rel="prefetch" href="/assets/js/47.824eb111.js"><link rel="prefetch" href="/assets/js/48.98dffaed.js"><link rel="prefetch" href="/assets/js/49.386a0bf2.js"><link rel="prefetch" href="/assets/js/5.1b9ac8a2.js"><link rel="prefetch" href="/assets/js/50.801be485.js"><link rel="prefetch" href="/assets/js/51.bb921d6a.js"><link rel="prefetch" href="/assets/js/52.9138b410.js"><link rel="prefetch" href="/assets/js/53.03965fb5.js"><link rel="prefetch" href="/assets/js/54.7205acc4.js"><link rel="prefetch" href="/assets/js/55.5fad64e6.js"><link rel="prefetch" href="/assets/js/56.fcc1e40d.js"><link rel="prefetch" href="/assets/js/57.cd843f1f.js"><link rel="prefetch" href="/assets/js/58.3fe7cf34.js"><link rel="prefetch" href="/assets/js/59.1aa3bd86.js"><link rel="prefetch" href="/assets/js/6.c838b021.js"><link rel="prefetch" href="/assets/js/60.54fd3619.js"><link rel="prefetch" href="/assets/js/61.63b1af5c.js"><link rel="prefetch" href="/assets/js/7.40f76512.js"><link rel="prefetch" href="/assets/js/8.c1ec3742.js"><link rel="prefetch" href="/assets/js/9.70967512.js">
    <link rel="stylesheet" href="/assets/css/0.styles.102bb3ad.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/feathers-logo-wide.png" alt="FeathersJS" class="logo"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guides/" class="nav-link">Guides</a></div><div class="nav-item"><a href="/api/" class="nav-link router-link-active">API</a></div><div class="nav-item"><a href="/cookbook/" class="nav-link">Cookbook</a></div><div class="nav-item"><a href="/help/" class="nav-link">Help</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Ecosystem</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/feathersjs/awesome-feathersjs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Awesome Feathersjs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.youtube.com/playlist?list=PLwSdIiqnDlf_lb5y1liQK2OW5daXYgKOe" target="_blank" rel="noopener noreferrer" class="nav-link external">
  YouTube Playlist
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://vuex.feathersjs.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Feathers VueX
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://hooks-common.feathersjs.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Common Hooks
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><h4>Other versions</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://dove.docs.feathersjs.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dove (v5, next)
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://buzzard.docs.feathersjs.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Buzzard (v3)
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://auk.docs.feathersjs.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Auk (v2)
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div> <a href="https://github.com/feathersjs/feathers" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guides/" class="nav-link">Guides</a></div><div class="nav-item"><a href="/api/" class="nav-link router-link-active">API</a></div><div class="nav-item"><a href="/cookbook/" class="nav-link">Cookbook</a></div><div class="nav-item"><a href="/help/" class="nav-link">Help</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Ecosystem</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/feathersjs/awesome-feathersjs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Awesome Feathersjs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.youtube.com/playlist?list=PLwSdIiqnDlf_lb5y1liQK2OW5daXYgKOe" target="_blank" rel="noopener noreferrer" class="nav-link external">
  YouTube Playlist
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://vuex.feathersjs.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Feathers VueX
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://hooks-common.feathersjs.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Common Hooks
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><h4>Other versions</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://dove.docs.feathersjs.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dove (v5, next)
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://buzzard.docs.feathersjs.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Buzzard (v3)
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://auk.docs.feathersjs.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Auk (v2)
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div> <a href="https://github.com/feathersjs/feathers" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Core</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/api/application.html" class="sidebar-link">Application</a></li><li><a href="/api/services.html" class="sidebar-link">Services</a></li><li><a href="/api/hooks.html" class="sidebar-link">Hooks</a></li><li><a href="/api/events.html" class="sidebar-link">Events</a></li><li><a href="/api/errors.html" class="sidebar-link">Errors</a></li><li><a href="/api/configuration.html" class="sidebar-link">Configuration</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Transports</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/api/express.html" class="sidebar-link">Express</a></li><li><a href="/api/socketio.html" class="sidebar-link">Socket.io</a></li><li><a href="/api/primus.html" class="sidebar-link">Primus</a></li><li><a href="/api/channels.html" class="sidebar-link">Channels</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Client</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/api/client.html" class="sidebar-link">Feathers Client</a></li><li><a href="/api/client/rest.html" class="sidebar-link">REST Client</a></li><li><a href="/api/client/socketio.html" class="sidebar-link">Socket.io Client</a></li><li><a href="/api/client/primus.html" class="sidebar-link">Primus Client</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Authentication</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/api/authentication/" class="sidebar-link">Overview</a></li><li><a href="/api/authentication/service.html" class="sidebar-link">Service</a></li><li><a href="/api/authentication/strategy.html" class="sidebar-link">Strategies</a></li><li><a href="/api/authentication/hook.html" class="sidebar-link">Hook</a></li><li><a href="/api/authentication/jwt.html" class="sidebar-link">JWT</a></li><li><a href="/api/authentication/local.html" class="sidebar-link">Local</a></li><li><a href="/api/authentication/oauth.html" class="active sidebar-link">OAuth</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/authentication/oauth.html#configuration" class="sidebar-link">Configuration</a></li><li class="sidebar-sub-header"><a href="/api/authentication/oauth.html#usage" class="sidebar-link">Usage</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/authentication/oauth.html#cookbook-guides" class="sidebar-link">Cookbook guides</a></li><li class="sidebar-sub-header"><a href="/api/authentication/oauth.html#flow" class="sidebar-link">Flow</a></li><li class="sidebar-sub-header"><a href="/api/authentication/oauth.html#oauth-urls" class="sidebar-link">oAuth URLs</a></li><li class="sidebar-sub-header"><a href="/api/authentication/oauth.html#account-linking" class="sidebar-link">Account linking</a></li><li class="sidebar-sub-header"><a href="/api/authentication/oauth.html#redirects" class="sidebar-link">Redirects</a></li></ul></li><li class="sidebar-sub-header"><a href="/api/authentication/oauth.html#setup-express" class="sidebar-link">Setup (Express)</a></li><li class="sidebar-sub-header"><a href="/api/authentication/oauth.html#oauthstrategy" class="sidebar-link">OAuthStrategy</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/authentication/oauth.html#entityid" class="sidebar-link">entityId</a></li><li class="sidebar-sub-header"><a href="/api/authentication/oauth.html#getentityquery-profile-params" class="sidebar-link">getEntityQuery(profile, params)</a></li><li class="sidebar-sub-header"><a href="/api/authentication/oauth.html#getentitydata-profile-entity-params" class="sidebar-link">getEntityData(profile, entity, params)</a></li><li class="sidebar-sub-header"><a href="/api/authentication/oauth.html#getprofile-data-params" class="sidebar-link">getProfile(data, params)</a></li><li class="sidebar-sub-header"><a href="/api/authentication/oauth.html#getredirect-data" class="sidebar-link">getRedirect (data)</a></li><li class="sidebar-sub-header"><a href="/api/authentication/oauth.html#getcurrententity-params" class="sidebar-link">getCurrentEntity(params)</a></li><li class="sidebar-sub-header"><a href="/api/authentication/oauth.html#findentity-profile-params" class="sidebar-link">findEntity(profile, params)</a></li><li class="sidebar-sub-header"><a href="/api/authentication/oauth.html#createentity-profile-params" class="sidebar-link">createEntity(profile, params)</a></li><li class="sidebar-sub-header"><a href="/api/authentication/oauth.html#updateentity-entity-profile-params" class="sidebar-link">updateEntity(entity, profile, params)</a></li><li class="sidebar-sub-header"><a href="/api/authentication/oauth.html#authenticate-authentication-params" class="sidebar-link">authenticate(authentication, params)</a></li></ul></li><li class="sidebar-sub-header"><a href="/api/authentication/oauth.html#customization" class="sidebar-link">Customization</a></li></ul></li><li><a href="/api/authentication/client.html" class="sidebar-link">Client</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Databases</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/api/databases/adapters.html" class="sidebar-link">Overview</a></li><li><a href="/api/databases/common.html" class="sidebar-link">Common API</a></li><li><a href="/api/databases/querying.html" class="sidebar-link">Querying</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="content content__default"><h1 id="oauth"><a href="#oauth" class="header-anchor">#</a> OAuth</h1> <p><a href="https://www.npmjs.com/package/@feathersjs/authentication-oauth" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/npm/v/@feathersjs/authentication-oauth.svg?style=flat-square" alt="npm version"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="https://github.com/feathersjs/feathers/blob/master/packages/authentication-oauth/CHANGELOG.md" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/badge/changelog-.md-blue.svg?style=flat-square" alt="Changelog"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language- extra-class"><pre class="language-text"><code>$ npm install @feathersjs/authentication-oauth --save
</code></pre></div><p><code>@feathersjs/authentication-oauth</code> allows to authenticate with over 180 oAuth providers (Google, Facebook, GitHub etc.) using <a href="https://github.com/simov/grant" target="_blank" rel="noopener noreferrer">grant<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, an oAuth middleware module for NodeJS.</p> <h2 id="configuration"><a href="#configuration" class="header-anchor">#</a> Configuration</h2> <p>The following settings are available:</p> <ul><li><code>redirect</code>: The URL of the frontend to redirect to with the access token (or error message). The <a href="/api/authentication/client.html">authentication client</a> handles those redirects automatically. If not set, the authentication result will be sent as JSON instead.</li> <li><code>defaults</code>: Default <a href="https://github.com/simov/grant#configuration" target="_blank" rel="noopener noreferrer">Grant configuration<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> used for all strategies. The following default options are set automatically:
<ul><li><code>path</code> (default: <code>'/oauth'</code>) - The oAuth base path</li></ul></li> <li><code>&lt;strategy-name&gt;</code> (e.g. <code>twitter</code>): The <a href="https://github.com/simov/grant#configuration" target="_blank" rel="noopener noreferrer">Grant configuration<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> used for a specific strategy.</li> <li>For both <code>defaults</code> and specific strategies, the following options are set automatically:
<ul><li><code>host</code>: Set to <code>host</code> from the configuration</li> <li><code>protocol</code>: <code>'http'</code> for development, <code>'https'</code> for production (when <code>NODE_ENV=production</code>)</li> <li><code>transport</code>: Set to <code>'session'</code> (see <a href="https://github.com/simov/grant#response-data-transport" target="_blank" rel="noopener noreferrer">Grant response data<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>)</li> <li><code>callback</code>: Set to <code>'&lt;defaults.path&gt;/&lt;name&gt;/authenticate'</code>. This should not be changed.</li></ul></li></ul> <blockquote><p><strong>Pro tip:</strong> Removing the <code>redirect</code> setting is a good way to troubleshoot oAuth authentication errors.</p></blockquote> <p>Standard oAuth authentication can be configured with those options in <code>config/default.json</code> like this:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;authentication&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;oauth&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;redirect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/frontend&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;google&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;secret&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;custom_params&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;access_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;offline&quot;</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;twitter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;secret&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p><strong>Note:</strong> All oAuth strategies will by default always look for configuration under <code>authentication.oauth.&lt;name&gt;</code>. If <code>authentication.oauth</code> is not set in the configuration, oAuth authentication will be disabled.</p></blockquote> <p>Here is a <a href="https://github.com/simov/grant#all-available-options" target="_blank" rel="noopener noreferrer">list of all Grant configuration options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> that are available:</p> <table><thead><tr><th style="text-align:left;">Key</th> <th style="text-align:left;">Location</th> <th style="text-align:left;">Description</th></tr></thead> <tbody><tr><td style="text-align:left;">request_url</td> <td style="text-align:left;"><a href="https://github.com/simov/grant/blob/master/config/oauth.json" target="_blank" rel="noopener noreferrer">oauth.json<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td> <td style="text-align:left;">OAuth1/step1</td></tr> <tr><td style="text-align:left;">authorize_url</td> <td style="text-align:left;"><a href="https://github.com/simov/grant/blob/master/config/oauth.json" target="_blank" rel="noopener noreferrer">oauth.json<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td> <td style="text-align:left;">OAuth1/step2 or OAuth2/step1</td></tr> <tr><td style="text-align:left;">access_url</td> <td style="text-align:left;"><a href="https://github.com/simov/grant/blob/master/config/oauth.json" target="_blank" rel="noopener noreferrer">oauth.json<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td> <td style="text-align:left;">OAuth1/step3 or OAuth2/step2</td></tr> <tr><td style="text-align:left;">oauth</td> <td style="text-align:left;"><a href="https://github.com/simov/grant/blob/master/config/oauth.json" target="_blank" rel="noopener noreferrer">oauth.json<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td> <td style="text-align:left;">OAuth version number</td></tr> <tr><td style="text-align:left;">scope_delimiter</td> <td style="text-align:left;"><a href="https://github.com/simov/grant/blob/master/config/oauth.json" target="_blank" rel="noopener noreferrer">oauth.json<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td> <td style="text-align:left;">string delimiter used for concatenating multiple scopes</td></tr> <tr><td style="text-align:left;">protocol, host, path</td> <td style="text-align:left;"><code>defaults</code></td> <td style="text-align:left;">used to generate <code>redirect_uri</code></td></tr> <tr><td style="text-align:left;">transport</td> <td style="text-align:left;"><code>defaults</code></td> <td style="text-align:left;"><a href="#response-data-transport">transport</a> to use to deliver the response data in your final <code>callback</code> route</td></tr> <tr><td style="text-align:left;">state</td> <td style="text-align:left;"><code>defaults</code></td> <td style="text-align:left;">toggle random <code>state</code> string generation for OAuth2</td></tr> <tr><td style="text-align:left;">key</td> <td style="text-align:left;"><code>[provider]</code></td> <td style="text-align:left;">OAuth app key, reserved aliases: <code>consumer_key</code> and <code>client_id</code></td></tr> <tr><td style="text-align:left;">secret</td> <td style="text-align:left;"><code>[provider]</code></td> <td style="text-align:left;">OAuth app secret, reserved aliases: <code>consumer_secret</code> and <code>client_secret</code></td></tr> <tr><td style="text-align:left;">scope</td> <td style="text-align:left;"><code>[provider]</code></td> <td style="text-align:left;">list of scopes to request</td></tr> <tr><td style="text-align:left;">custom_params</td> <td style="text-align:left;"><code>[provider]</code></td> <td style="text-align:left;">custom authorization <a href="#custom-parameters">parameters</a> and their values</td></tr> <tr><td style="text-align:left;">subdomain</td> <td style="text-align:left;"><code>[provider]</code></td> <td style="text-align:left;">string to be <a href="#subdomain-urls">embedded</a> in <code>request_url</code>, <code>authorize_url</code> and <code>access_url</code></td></tr> <tr><td style="text-align:left;">nonce</td> <td style="text-align:left;"><code>[provider]</code></td> <td style="text-align:left;">toggle random <code>nonce</code> string generation for <a href="#openid-connect">OpenID Connect</a> providers</td></tr> <tr><td style="text-align:left;">callback</td> <td style="text-align:left;"><code>[provider]</code></td> <td style="text-align:left;">final callback route on your server to receive the <a href="#response-data">response data</a></td></tr> <tr><td style="text-align:left;">dynamic</td> <td style="text-align:left;"><code>[provider]</code></td> <td style="text-align:left;">allow <a href="#dynamic-override">dynamic override</a> of configuration</td></tr> <tr><td style="text-align:left;">overrides</td> <td style="text-align:left;"><code>[provider]</code></td> <td style="text-align:left;"><a href="#static-overrides">static overrides</a> for a provider</td></tr> <tr><td style="text-align:left;">response</td> <td style="text-align:left;"><code>[provider]</code></td> <td style="text-align:left;"><a href="#limit-response-data">limit</a> the response data</td></tr> <tr><td style="text-align:left;">token_endpoint_auth_method</td> <td style="text-align:left;"><code>[provider]</code></td> <td style="text-align:left;">authentication method for the <a href="#token-endpoint-auth-method">token endpoint</a></td></tr> <tr><td style="text-align:left;">name</td> <td style="text-align:left;">generated</td> <td style="text-align:left;">provider's <a href="#grant">name</a>, used to generate <code>redirect_uri</code></td></tr> <tr><td style="text-align:left;">profile_url</td> <td style="text-align:left;"><a href="https://github.com/simov/grant-profile" target="_blank" rel="noopener noreferrer">grant-profile<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td> <td style="text-align:left;">The URL to retrieve the user profile from</td></tr> <tr><td style="text-align:left;">[provider]</td> <td style="text-align:left;">generated</td> <td style="text-align:left;">provider's <a href="#grant">name</a> as key</td></tr> <tr><td style="text-align:left;">redirect_uri</td> <td style="text-align:left;">generated</td> <td style="text-align:left;">OAuth app <a href="#redirect-uri">redirect URI</a>, generated using <code>protocol</code>, <code>host</code>, <code>path</code> and <code>name</code></td></tr></tbody></table> <h2 id="usage"><a href="#usage" class="header-anchor">#</a> Usage</h2> <h3 id="cookbook-guides"><a href="#cookbook-guides" class="header-anchor">#</a> Cookbook guides</h3> <p>For specific oAuth provider setup see the following <a href="/cookbook/">cookbook</a> guides:</p> <ul><li><a href="/cookbook/authentication/auth0.html">Auth0</a></li> <li><a href="/cookbook/authentication/facebook.html">Facebook</a></li> <li><a href="/cookbook/authentication/google.html">Google</a></li></ul> <h3 id="flow"><a href="#flow" class="header-anchor">#</a> Flow</h3> <p>There are two ways to initiate oAuth authentication:</p> <ol><li><p>Through the browser (most common)</p> <ul><li>User clicks on link to oAuth URL (<code>oauth/&lt;provider&gt;</code>)</li> <li>Gets redirected to provider and authorizes the application</li> <li>Callback to the <a href="#oauthstrategy">OauthStrategy</a> which
<ul><li>Gets the users profile</li> <li>Finds or creates the user (entity) for that profile</li></ul></li> <li>The <a href="/api/authentication/service.html">AuthenticationService</a> creates an access token for that entity</li> <li>Redirect to the <code>redirect</code> URL including the generated access token</li> <li>The frontend (e.g. <a href="/api/authentication/client.html">authentication client</a>) uses the returned access token to authenticate</li></ul></li> <li><p>With an existing access token, e.g. obtained through the Facebook mobile SDK</p> <ul><li>Authenticate normally with <code>{ strategy: '&lt;name&gt;', access_token: 'oauth access token' }</code>.</li> <li>Calls the <a href="#oauthstrategy">OauthStrategy</a> which
<ul><li>Gets the users profile</li> <li>Finds or creates the entity for that profile</li></ul></li> <li>Returns the authentication result</li></ul></li></ol> <blockquote><p><strong>Note:</strong> If you are attempting to authenticate using an obtained access token, ensure that you have added the strategy (e.g. 'facebook') to your <a href="/api/authentication/service.html#configuration">authStrategies</a>.</p></blockquote> <h3 id="oauth-urls"><a href="#oauth-urls" class="header-anchor">#</a> oAuth URLs</h3> <p>There are several URLs and redirects that are important for oAuth authentication:</p> <ul><li><code>http(s)://&lt;host&gt;/oauth/&lt;provider&gt;</code>: The main URL to initiate the oAuth flow. Link to this from the browser.</li> <li><code>http(s)://&lt;host&gt;/oauth/&lt;provider&gt;/callback</code>: The callback path that should be set in the oAuth application settings</li> <li><code>http(s)://&lt;host&gt;/oauth/&lt;provider&gt;/authenticate</code>: The internal redirect</li></ul> <p>In the browser any oAuth flow can be initiated with the following link:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/oauth/github<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Login with GitHub<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="account-linking"><a href="#account-linking" class="header-anchor">#</a> Account linking</h3> <p>To <em>link an existing user</em> the current access token can be added to the oAuth flow query using the <code>feathers_token</code> query parameter:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/oauth/github?feathers_token=&lt;your access token&gt;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  Login with GitHub
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>This will use the user (entity) of that access token to link the oAuth account to. Using the <a href="/api/authentication/client.html">authentication client</a> you can get the current access token via <code>app.get('authentication')</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> accessToken <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'authentication'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="redirects"><a href="#redirects" class="header-anchor">#</a> Redirects</h3> <p>The <code>redirect</code> configuration option is used to redirect back to the frontend application after oAuth authentication was successful and an access token for the user has been created by the <a href="/api/authentication/service.html">authentication service</a> or if authentication failed. It works cross domain and by default includes the access token or error message in the window location hash. The following configuration</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;authentication&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;oauth&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;redirect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://app.mydomain.com/&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Will redirect to <code>https://app.mydomain.com/#access_token=&lt;user jwt&gt;</code> or <code>https://app.mydomain.com/#error=&lt;some error message&gt;</code>. Redirects can be customized with the <a href="#getredirect-data">getRedirect()</a> method of the oAuth strategy. The <a href="/api/authentication/client.html">authentication client</a> handles the default redirects automatically already.</p> <blockquote><p><strong>Note:</strong> The redirect is using a hash instead of a query string by default because it is not logged server side and can be easily read on the client. You can force query based redirect by adding a <code>?</code> to the end of the <code>redirect</code> option.</p></blockquote> <p>If the <code>redirect</code> option is not set, the authentication result data will be sent as JSON instead.</p> <p>Dynamic redirects to the same URL are possible by setting the <code>redirect</code> query parameter in the oAuth flow. For example, the following oAuth link:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/oauth/github?redirect=dashboard<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  Login with GitHub
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>With the above configuration will redirect to <code>https://app.mydomain.com/dashboard</code> after the oAuth flow.</p> <h2 id="setup-express"><a href="#setup-express" class="header-anchor">#</a> Setup (Express)</h2> <p><code>expressOauth</code> (for setup see the <a href="/api/authentication/service.html">AuthenticationService</a>) sets up oAuth authentication on a <a href="/api/express.html">Feathers Express</a> application and can take the following options:</p> <ul><li><code>authService</code>: The name of the authentication service</li> <li><code>linkStrategy</code> (default: <code>'jwt'</code>): The name of the strategy to use for account linking</li> <li><code>expressSession</code> (default: <code>require('express-session')()</code>): The <a href="https://github.com/expressjs/session" target="_blank" rel="noopener noreferrer">Express session<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> middleware to use. Uses in-memory sessions by default but may need to be customized to a persistent storage when using multiple instances of the application. Other sessions stores can be used by setting the <code>expressSession</code> option using a different memory store, e.g. <a href="https://github.com/tj/connect-redis" target="_blank" rel="noopener noreferrer">connect-redis<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> in the authentication configuration:</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> redis <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'redis'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> session <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express-session'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> expressOauth <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@feathersjs/authentication-oauth'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> RedisStore <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'connect-redis'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span>
<span class="token keyword">const</span> redisClient <span class="token operator">=</span> redis<span class="token punctuation">.</span><span class="token function">createClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token function">expressOauth</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  expressSession<span class="token operator">:</span> <span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    store<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">RedisStore</span><span class="token punctuation">(</span><span class="token punctuation">{</span> client<span class="token operator">:</span> redisClient <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    secret<span class="token operator">:</span> <span class="token string">'keyboard cat'</span><span class="token punctuation">,</span>
    resave<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p><strong>Important:</strong>  If not customized, Express oAuth uses the in-memory Express session store which will show a <code>connect.session() MemoryStore is not designed for a production environment, as it will leak memory, and will not scale past a single process.</code> warning in production.</p></blockquote> <h2 id="oauthstrategy"><a href="#oauthstrategy" class="header-anchor">#</a> OAuthStrategy</h2> <h3 id="entityid"><a href="#entityid" class="header-anchor">#</a> entityId</h3> <p><code>oauthStrategy.entityId -&gt; string</code> returns the name of the id property of the entity.</p> <h3 id="getentityquery-profile-params"><a href="#getentityquery-profile-params" class="header-anchor">#</a> getEntityQuery(profile, params)</h3> <p><code>oauthStrategy.getEntityQuery(profile, params) -&gt; Promise</code> returns the entity lookup query to find the entity for a profile. By default returns</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">Id</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token operator">:</span> profile<span class="token punctuation">.</span>sub <span class="token operator">||</span> profile<span class="token punctuation">.</span>id
<span class="token punctuation">}</span>
</code></pre></div><h3 id="getentitydata-profile-entity-params"><a href="#getentitydata-profile-entity-params" class="header-anchor">#</a> getEntityData(profile, entity, params)</h3> <p><code>oauthStrategy.getEntityData(profile, existing, params) -&gt; Promise</code>  returns the data to either create a new or update an existing entity. <code>entity</code> is either the existing entity or <code>null</code> when creating a new entity.</p> <h3 id="getprofile-data-params"><a href="#getprofile-data-params" class="header-anchor">#</a> getProfile(data, params)</h3> <p><code>oauthStrategy.getProfile(data, params) -&gt; Promise</code> returns the user profile information from the oAuth provider that was used for the login. <code>data</code> is the oAuth callback information which normally contains e.g. the oAuth access token.</p> <h3 id="getredirect-data"><a href="#getredirect-data" class="header-anchor">#</a> getRedirect (data)</h3> <p><code>oauthStrategy.getRedirect(data) -&gt; Promise</code> returns the URL to redirect to after a successful oAuth login and entity lookup or creation. By default it redirects to <code>authentication.oauth.redirect</code> from the configuration with <code>#access_token=&lt;access token for entity&gt;</code> added to the end of the URL. The <code>access_token</code> hash is e.g. used by the <a href="/api/authentication/client.html">authentication client</a> to log the user in after a successful oAuth login. The default redirects do work cross domain.</p> <h3 id="getcurrententity-params"><a href="#getcurrententity-params" class="header-anchor">#</a> getCurrentEntity(params)</h3> <p><code>oauthStrategy.getCurrentEntity(params) -&gt; Promise</code> returns the currently linked entity for the given <code>params</code>. It will either use the entity authenticated by <code>params.authentication</code> or return <code>null</code>.</p> <h3 id="findentity-profile-params"><a href="#findentity-profile-params" class="header-anchor">#</a> findEntity(profile, params)</h3> <p><code>oauthStrategy.findEntity(profile, params) -&gt; Promise</code> finds an entity for a given oAuth profile. Uses <code>{ [${this.name}Id]: profile.id }</code> by default.</p> <h3 id="createentity-profile-params"><a href="#createentity-profile-params" class="header-anchor">#</a> createEntity(profile, params)</h3> <p><code>oauthStrategy.createEntity(profile, params) -&gt; Promise</code> creates a new entity for the given oAuth profile. Uses <code>{ [${this.name}Id]: profile.id }</code> by default.</p> <h3 id="updateentity-entity-profile-params"><a href="#updateentity-entity-profile-params" class="header-anchor">#</a> updateEntity(entity, profile, params)</h3> <p><code>oauthStrategy.updateEntity(entity, profile, params) -&gt; Promise</code> updates an existing entity with the given profile. Uses <code>{ [${this.name}Id]: profile.id }</code> by default.</p> <h3 id="authenticate-authentication-params"><a href="#authenticate-authentication-params" class="header-anchor">#</a> authenticate(authentication, params)</h3> <p><code>oauthStrategy.authenticate(authentication, params)</code> is the main endpoint implemented by any <a href="/api/authentication/strategy.html">authentication strategy</a>. It is usually called for authentication requests for this strategy by the <a href="/api/authentication/service.html">AuthenticationService</a>.</p> <h2 id="customization"><a href="#customization" class="header-anchor">#</a> Customization</h2> <p>Normally, any oAuth provider set up in the <a href="#configuration">configuration</a> will be initialized with the default <a href="#oauthstrategy">OAuthStrategy</a>. The flow for a specific provider can be customized by extending <code>OAuthStrategy</code> class and registering it under that name on the <a href="/api/authentication/service.html">AuthenticationService</a>:</p> <div class="tabs-component"><ul role="tablist" class="tabs-component-tabs"></ul> <div class="tabs-component-panels"><section aria-hidden="true" id="javascript" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> AuthenticationService<span class="token punctuation">,</span> JWTStrategy <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@feathersjs/authentication'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> OAuthStrategy <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@feathersjs/authentication-oauth'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MyGithubStrategy</span> <span class="token keyword">extends</span> <span class="token class-name">OAuthStrategy</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">getEntityData</span><span class="token punctuation">(</span><span class="token parameter">profile</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Include the `email` from the GitHub profile when creating</span>
    <span class="token comment">// or updating a user that logged in with GitHub</span>
    <span class="token keyword">const</span> baseData <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">getEntityData</span><span class="token punctuation">(</span>profile<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span>baseData<span class="token punctuation">,</span>
      email<span class="token operator">:</span> profile<span class="token punctuation">.</span>email
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">app</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> authService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AuthenticationService</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>

  authService<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'github'</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">MyGithubStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// ...</span>
  app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/authentication'</span><span class="token punctuation">,</span> authService<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></section> <section aria-hidden="true" id="typescript" role="tabpanel" class="tabs-component-panel" style="display:none;"><div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Application <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@feathersjs/feathers'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AuthenticationService<span class="token punctuation">,</span> JWTStrategy <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@feathersjs/authentication'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> OAuthStrategy <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@feathersjs/authentication-oauth'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MyGithubStrategy</span> <span class="token keyword">extends</span> <span class="token class-name">OAuthStrategy</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">getEntityData</span><span class="token punctuation">(</span><span class="token parameter">profile<span class="token operator">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Include the `email` from the GitHub profile when creating</span>
    <span class="token comment">// or updating a user that logged in with GitHub</span>
    <span class="token keyword">const</span> baseData <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">getEntityData</span><span class="token punctuation">(</span>profile<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span>baseData<span class="token punctuation">,</span>
      email<span class="token operator">:</span> profile<span class="token punctuation">.</span>email
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token parameter">app<span class="token operator">:</span> Application</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> authService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AuthenticationService</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>

  authService<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'github'</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">MyGithubStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// ...</span>
  app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/authentication'</span><span class="token punctuation">,</span> authService<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></section></div></div></div> <footer class="page-edit"><blockquote><p>
        Anything unclear or missing?
        <a href="https://github.com/feathersjs/docs/issues/new?title=Comment: OAuth (api/authentication/oauth.md)" target="_blank" rel="noopener noreferrer">
          Leave a comment
        </a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> or <a href="https://github.com/feathersjs/docs/edit/master/api/authentication/oauth.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></p> <small><span class="prefix">Last Updated: </span> <span class="time">1/29/2020, 4:07:15 AM</span></small></blockquote></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/api/authentication/local.html" class="prev">
          Local
        </a></span> <span class="next"><a href="/api/authentication/client.html">
          Client
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.59d86e45.js" defer></script><script src="/assets/js/2.88ab971d.js" defer></script><script src="/assets/js/20.c87b6b4b.js" defer></script>
  </body>
</html>
